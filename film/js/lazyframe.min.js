!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.lazyframe=t()}(this,function(){"use strict";var s,a,o,l,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};return o={vendor:s=void 0,id:void 0,src:void 0,thumbnail:void 0,title:void 0,apikey:void 0,initialized:!(a=[]),parameters:void 0,y:void 0,debounce:250,lazyload:!0,initinview:!1,onLoad:function(e){},onAppend:function(e){},onThumbnailLoad:function(e){}},l={regex:{youtube_nocookie:/(?:youtube-nocookie\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=)))([a-zA-Z0-9_-]{6,11})/,youtube:/(?:youtube\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=))|youtu\.be\/)([a-zA-Z0-9_-]{6,11})/,vimeo:/vimeo\.com\/(?:video\/)?([0-9]*)(?:\?|)/,vine:/vine.co\/v\/(.*)/},condition:{youtube:function(e){return!(!e||11!=e[1].length)&&e[1]},youtube_nocookie:function(e){return!(!e||11!=e[1].length)&&e[1]},vimeo:function(e){return!!(e&&9===e[1].length||8===e[1].length)&&e[1]},vine:function(e){return!(!e||11!==e[1].length)&&e[1]}},src:{youtube:function(e){return"https://www.youtube.com/embed/"+e.id+"/?"+e.parameters},youtube_nocookie:function(e){return"https://www.youtube-nocookie.com/embed/"+e.id+"/?"+e.parameters},vimeo:function(e){return"https://player.vimeo.com/video/"+e.id+"/?"+e.parameters},vine:function(e){return"https://vine.co/v/"+e.id+"/embed/simple"}},endpoints:{youtube:function(e){return"https://www.googleapis.com/youtube/v3/videos?id="+e.id+"&key="+e.apikey+"&fields=items(snippet(title,thumbnails))&part=snippet"},youtube_nocookie:function(e){return"https://www.googleapis.com/youtube/v3/videos?id="+e.id+"&key="+e.apikey+"&fields=items(snippet(title,thumbnails))&part=snippet"},vimeo:function(e){return"https://vimeo.com/api/oembed.json?url=https%3A//vimeo.com/"+e.id},vine:function(e){return"https://vine.co/oembed.json?url=https%3A%2F%2Fvine.co%2Fv%2F"+e.id}},response:{youtube:{title:function(e){return e.items[0].snippet.title},thumbnail:function(e){var t=e.items[0].snippet.thumbnails;return(t.maxres||t.standard||t.high||t.medium||t.default).url}},youtube_nocookie:{title:function(e){return e.items[0].snippet.title},thumbnail:function(e){var t=e.items[0].snippet.thumbnails;return(t.maxres||t.standard||t.high||t.medium||t.default).url}},vimeo:{title:function(e){return e.title},thumbnail:function(e){return e.thumbnail_url}},vine:{title:function(e){return e.title},thumbnail:function(e){return e.thumbnail_url}}}},function(e){if(s=r({},o,arguments.length<=1?void 0:arguments[1]),"string"==typeof e)for(var t=document.querySelectorAll(e),n=0;n<t.length;n++)u(t[n]);else if(void 0===e.length)u(e);else if(1<e.length)for(var i=0;i<e.length;i++)u(e[i]);else u(e[0]);s.lazyload&&function(){function e(e,t){e.settings.initialized=!0,e.el.classList.add("lazyframe--loaded"),i--,c(e),e.settings.initinview&&e.el.click(),e.settings.onLoad.call(n,e)}var n=this,t=window.innerHeight,i=a.length;a.filter(function(e){return e.settings.y<t}).forEach(e);var o=function(n,i){var o=void 0;return function(){var e=this,t=arguments;clearTimeout(o),o=setTimeout(function(){o=null,n.apply(e,t)},i)}}(function(){u=r<window.pageYOffset,r=window.pageYOffset,u&&a.filter(function(e){return e.settings.y<t+r&&!1===e.settings.initialized}).forEach(e),0===i&&window.removeEventListener("scroll",o,!1)},s.debounce),r=0,u=!1;window.addEventListener("scroll",o,!1)}()};function u(t){var n=this;if(t instanceof HTMLElement!=0&&!t.classList.contains("lazyframe--loaded")){var i={el:t,settings:function(e){var t=Array.prototype.slice.apply(e.attributes).filter(function(e){return""!==e.value}).reduce(function(e,t){return e[0===t.name.indexOf("data-")?t.name.split("data-")[1]:t.name]=t.value,e},{}),n=r({},s,t,{y:e.offsetTop,parameters:function(e){var t=e.split("?");if(t[1])return-1!==(t=t[1]).indexOf("autoplay")?t:t+"&autoplay=1";return"autoplay=1"}(t.src)});if(n.vendor){var i=n.src.match(l.regex[n.vendor]);n.id=l.condition[n.vendor](i)}return n}(t)};i.el.addEventListener("click",function(){i.el.appendChild(i.iframe);var e=t.querySelectorAll("iframe");i.settings.onAppend.call(n,e[0])}),s.lazyload?d(i):c(i,i.settings.thumbnail)}}function c(r){var t,n,e,i,o,u=this;!(o=r.settings).vendor||o.title&&o.thumbnail||!("youtube"!==o.vendor&&"youtube_nocookie"!==o.vendor||o.apikey)?d(r,!0):(t=r,n=function(e,t){if(!e){var n=t[0],i=t[1];if(i.settings.title||(i.settings.title=l.response[i.settings.vendor].title(n)),!i.settings.thumbnail){var o=l.response[i.settings.vendor].thumbnail(n);i.settings.thumbnail=o,r.settings.onThumbnailLoad.call(u,o)}d(i,!0)}},e=l.endpoints[t.settings.vendor](t.settings),(i=new XMLHttpRequest).open("GET",e,!0),i.onload=function(){if(200<=i.status&&i.status<400){var e=JSON.parse(i.responseText);n(null,[e,t])}else n(!0)},i.onerror=function(){n(!0)},i.send())}function d(e,t){if(e.iframe=function(e){var t=document.createDocumentFragment(),n=document.createElement("iframe");if(e.vendor&&(e.src=l.src[e.vendor](e)),n.setAttribute("id","lazyframe-"+e.id),n.setAttribute("src",e.src),n.setAttribute("frameborder",0),n.setAttribute("allowfullscreen",""),"vine"===e.vendor){var i=document.createElement("script");i.setAttribute("src","https://platform.vine.co/static/scripts/embed.js"),t.appendChild(i)}return t.appendChild(n),t}(e.settings),e.settings.thumbnail&&t&&(e.el.style.backgroundImage="url("+e.settings.thumbnail+")"),e.settings.title&&0===e.el.children.length){var n=document.createDocumentFragment(),i=document.createElement("span");i.className="lazyframe__title",i.innerHTML=e.settings.title,n.appendChild(i),e.el.appendChild(n)}s.lazyload||(e.el.classList.add("lazyframe--loaded"),e.settings.onLoad.call(this,e),a.push(e)),e.settings.initialized||a.push(e)}});